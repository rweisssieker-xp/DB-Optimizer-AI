<UserControl x:Class="DBOptimizer.WpfApp.Views.PerformanceCrystalBallView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1000">
    <Grid Background="#F5F5F5">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="30">
                <TextBlock Text="🔮 Performance Crystal Ball - Predictive What-If Scenarios"
                          FontSize="28" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,20"/>

                <TextBlock Text="See the future - Performance predictions for your business growth"
                          FontSize="14" Foreground="#7F8C8D" Margin="0,0,0,30"/>

                <!-- Scenario Selection -->
                <Border Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,20"
                       BorderBrush="#E0E0E0" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Select Scenario" FontSize="18" FontWeight="SemiBold"
                                  Foreground="#34495E" Margin="0,0,0,15"/>

                        <ComboBox ItemsSource="{Binding PredefinedScenarios}"
                                 SelectedItem="{Binding SelectedScenario}"
                                 DisplayMemberPath="Name"
                                 Padding="8" FontSize="14" Margin="0,0,0,15"/>

                        <Button Content="🔮 Predict Future Performance"
                               Command="{Binding PredictScenarioCommand}"
                               IsEnabled="{Binding IsPredicting, Converter={StaticResource InverseBoolConverter}}"
                               Background="#9B59B6" Foreground="White"
                               FontSize="16" FontWeight="Bold" Padding="15"
                               BorderThickness="0" Cursor="Hand" Height="50"/>
                    </StackPanel>
                </Border>

                <!-- Status -->
                <Border Background="#3498DB" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                    <TextBlock Text="{Binding StatusMessage}" Foreground="White" FontSize="14" TextWrapping="Wrap"/>
                </Border>

                <!-- Forecast Results -->
                <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E0E0E0" BorderThickness="1"
                       Visibility="{Binding CurrentForecast, Converter={StaticResource NullToVisibilityConverter}}">
                    <StackPanel>
                        <TextBlock Text="📊 Forecast Results" FontSize="20" FontWeight="SemiBold"
                                  Foreground="#9B59B6" Margin="0,0,0,15"/>

                        <!-- Predictions -->
                        <TextBlock Text="Predicted Metrics:" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                        <ItemsControl ItemsSource="{Binding CurrentForecast.Predictions}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#ECF0F1" Margin="0,0,0,10" Padding="15" CornerRadius="5">
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                                <TextBlock Text="{Binding MetricName}" FontWeight="SemiBold" FontSize="14"/>
                                                <TextBlock Text="{Binding Risk, StringFormat=' - {0} Risk'}" 
                                                          Foreground="#E74C3C" Margin="5,0"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Current: "/>
                                                <TextBlock Text="{Binding CurrentValue, StringFormat='{}{0:F1}'}" FontWeight="Bold"/>
                                                <TextBlock Text=" → " Margin="5,0"/>
                                                <TextBlock Text="Predicted: "/>
                                                <TextBlock Text="{Binding PredictedValue, StringFormat='{}{0:F1}'}" 
                                                          FontWeight="Bold" Foreground="#E67E22"/>
                                                <TextBlock Text="{Binding ChangePercent, StringFormat=' ({0:+0.0;-0.0}%)'}" 
                                                          Margin="5,0"/>
                                            </StackPanel>
                                            <TextBlock Text="{Binding Explanation}" Foreground="#7F8C8D" 
                                                      Margin="0,5,0,0" TextWrapping="Wrap"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- Bottleneck Alerts -->
                        <TextBlock Text="⚠️ Bottleneck Alerts:" FontSize="16" FontWeight="SemiBold" 
                                  Margin="0,15,0,10"
                                  Visibility="{Binding CurrentForecast.BottleneckAlerts.Count, Converter={StaticResource CountToVisibilityConverter}}"/>
                        <ItemsControl ItemsSource="{Binding CurrentForecast.BottleneckAlerts}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" Foreground="#E74C3C" Margin="0,0,0,5" TextWrapping="Wrap"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- Recommendations -->
                        <TextBlock Text="🎯 Recommendations:" FontSize="16" FontWeight="SemiBold" 
                                  Margin="0,15,0,10"
                                  Visibility="{Binding CurrentForecast.Recommendations.Count, Converter={StaticResource CountToVisibilityConverter}}"/>
                        <ItemsControl ItemsSource="{Binding CurrentForecast.Recommendations}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" Foreground="#27AE60" Margin="0,0,0,5" TextWrapping="Wrap"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>

